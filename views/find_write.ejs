<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>부동산 도우미 - 매물찾아요</title>
  <meta name="description" content="부동산 업무에 종사하는 분들에게 도움을 드립니다">

  <!-- 브라우저 css 기본스타일 초기화 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reset-css@5.0.2/reset.min.css">

  <!-- ajax 사용을 위한 제이쿼리 -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  
  <!-- css 링크  -->
  <link rel="stylesheet" href="../css/main.css">
  <link rel="stylesheet" href="../css/header.css">
  <link rel="stylesheet" href="../css/find/find_write.css">

  <!-- ckeditor cdn 방식  -->
	<link rel="stylesheet" href="https://cdn.ckeditor.com/ckeditor5/43.0.0/ckeditor5.css">

  <!-- js 링크  -->
  <!-- <script src="../js/find/find_write.js" type="module"></script> -->
</head>

<body>

  <!-- ===== header ===== -->
  <header>
    <%- include('header', {user:user}) %>
  </header>

  <div id="contents"> 

		<!-- page title -->
    <div class="page_title">
      <span>매물찾아요 등록</span>
    </div>

    <!-- <div class="input_title">
      <label for="title">제목</label>
      <input type="text" id="title"> <br>
    </div> -->

		<div>
			<div class="main-container">

        <input type="text" class="input_title" placeholder="제목을 입력하세요"> <br>

				<div class="editor-container editor-container_classic-editor" id="editor-container">
					<div class="editor-container__editor"><div id="editor"></div></div>
				</div>
			</div>
		</div>

		<input type="button" value="등록" onclick="postFind()">
    <!-- <button type="button" onclick="postFind()">등록</button> -->

		<script type="importmap">
		{
			"imports": {
				"ckeditor5": "https://cdn.ckeditor.com/ckeditor5/43.0.0/ckeditor5.js",
				"ckeditor5/": "https://cdn.ckeditor.com/ckeditor5/43.0.0/"
			}
		}
		</script>
		<script src="../js/find/find_write.js" type="module"></script>

    <script>
      function postFind() {
      let title = document.querySelector(".input_title").value;
      let content = window.editor.getData();
      // window.editor.getData(); 가져오기
      // window.editor.setData(); 세팅하기

      if(title == "")
        alert("제목을 입력하세요");
      else if(content == "")
        alert("내용을 입력하세요");
      else {
        $.ajax({
          url : "/find_post",
          type : "POST",
          data : {title:title, content:content},
          success : function(data) {
            alert("등록 되었습니다")
            window.location.href = '/find_list';
          },
          error : function(xhr, textStatus, errorThrown) {
            console.log("매물찾아요 등록실패");
            console.log(xhr, textStatus, errorThrown);
          }
        })
      }
    }
    </script>

  </div> 

</body>
</html>